import{j as e}from"./index-DmOvnXxr.js";import{a as x,b as g,m as j}from"./icons-Dv_jQHI5.js";import{b as h}from"./index-DGnxsfR-.js";import"./firebase-BML4XxfO.js";const S=({show:u,team:n,setTeam:d})=>{const[l,i]=x.useState(null),[c,m]=x.useState(""),[w,r]=x.useState("");if(!u)return null;const f=async(s,t)=>{if(!window.confirm(`Reset password for this user to: ${t}?`))return;const a=await h.hash(t,10);d(o=>o.map(p=>p.id===s?{...p,password:a,requirePasswordChange:!0}:p)),r(`Password reset for ${n.find(o=>o.id===s)?.name}`),setTimeout(()=>r(""),3e3),i(null)},y=async s=>{if(!c){r("Please enter a password");return}const t=await h.hash(c,10);d(a=>a.map(o=>o.id===s?{...o,password:t,requirePasswordChange:!0}:o)),r(`Password set for ${n.find(a=>a.id===s)?.name}`),setTimeout(()=>r(""),3e3),m(""),i(null)},b=async()=>{const s=n.filter(a=>a.password&&!a.password.startsWith("$2")).length;if(s===0){r("All passwords are already encrypted!"),setTimeout(()=>r(""),3e3);return}if(!window.confirm(`This will encrypt ${s} plain-text password(s). All users will need to change their password on next login. Continue?`))return;r("Encrypting passwords...");const t=await Promise.all(n.map(async a=>{if(!a.password||a.password.startsWith("$2"))return a;const o=await h.hash(a.password,10);return{...a,password:o,requirePasswordChange:!0}}));d(t),r(`Successfully encrypted ${s} password(s)!`),setTimeout(()=>r(""),5e3)};return e.jsxs("div",{className:"w-80 bg-white border-l shadow-lg overflow-y-auto flex flex-col h-full",children:[e.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-red-600 to-red-700 text-white p-4 flex items-center justify-between border-b shadow-md",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{size:20}),e.jsx("h2",{className:"font-bold text-lg",children:"Admin Panel"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[w&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 p-3 rounded text-sm",children:w}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-2 flex items-center gap-2",children:[e.jsx(g,{size:16,className:"text-yellow-600"}),"Security Actions"]}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Encrypt all plain-text passwords in the database. This is a one-time operation."}),e.jsx("button",{onClick:b,className:"w-full px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition font-medium text-sm shadow-sm",children:"ðŸ”’ Encrypt All Passwords"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 mb-3",children:"User Management"}),e.jsx("div",{className:"space-y-2",children:n.map(s=>e.jsxs("div",{className:"bg-gray-50 border rounded p-3 cursor-pointer hover:bg-gray-100",onClick:()=>i(l===s.id?null:s.id),children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.role})]}),l===s.id&&e.jsx(j,{size:16,className:"text-gray-400"})]}),l===s.id&&e.jsxs("div",{className:"mt-3 pt-3 border-t space-y-2",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),f(s.id,"1234")},className:"w-full px-3 py-2 bg-orange-100 text-orange-700 rounded hover:bg-orange-200 transition text-sm font-medium",children:"Reset to Default (1234)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"password",placeholder:"New password",value:c,onChange:t=>m(t.target.value),onClick:t=>t.stopPropagation(),className:"flex-1 px-2 py-1 border rounded text-xs"}),e.jsx("button",{onClick:t=>{t.stopPropagation(),y(s.id)},className:"px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition text-xs font-medium",children:"Set"})]}),e.jsx("div",{className:"text-[11px] text-gray-500 bg-gray-100 p-2 rounded",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Requires Password Change:"})," ",s.requirePasswordChange?"Yes":"No"]})})]})]},s.id))})]})]})]})};export{S as AdminPanel};
